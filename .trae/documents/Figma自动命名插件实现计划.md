# Figma自动命名插件实现计划

## 1. 功能需求分析
- 插件UI：输入框 + "马上重命名"按钮（符合UI设计系统规范）
- 核心功能：获取选中frame结构 → 调用AI分析 → 自动命名frame内容
- AI集成：接入火山AI模型Doubao-Seed-1.8
- 命名逻辑：基于内置命名规范和案例进行AI分析

## 2. 实现步骤

### 2.1 UI界面设计与实现
- 修改`src/ui.html`：
  - 更新标题为"AI自动命名工具"
  - 采用UI设计系统的按钮和输入框样式
  - 主按钮使用`btn-large-secondary`样式，文本"马上重命名"
  - 输入框使用`mp4-size-input-wrapper`类似样式，用于用户自定义命名提示
  - 添加状态显示区域，使用`toast-message`样式显示命名结果
  - 确保UI符合设计系统的颜色、字体、间距规范

### 2.2 Figma结构获取
- 在`src/main.ts`中实现：
  - 监听用户选择事件，获取选中的frame
  - 递归遍历frame内所有元素（画框、图形、文本、组件等）
  - 提取元素属性：类型、尺寸、位置、当前名称、内容（文本）、样式等
  - 构建结构化数据：
    ```javascript
    {
      frameName: "当前frame名称",
      elements: [
        {
          id: "元素ID",
          type: "RECTANGLE/TEXT/FRAME/COMPONENT",
          name: "当前名称",
          width: 100,
          height: 100,
          x: 0,
          y: 0,
          textContent: "文本内容（如果是文本元素）",
          // 其他相关属性
        }
      ]
    }
    ```

### 2.3 AI服务集成
- 创建AI服务模块`src/ai-service.ts`：
  - 实现火山AI API调用逻辑（需要用户提供API密钥）
  - 设计提示词模板，包含：
    - 命名规范（如：使用语义化名称、驼峰命名、功能优先等）
    - 命名案例（如："登录按钮"、"标题文本"、"用户头像容器"等）
    - 待命名元素的结构化数据
  - 处理AI返回结果，解析命名建议

### 2.4 自动命名逻辑
- 实现命名更新功能：
  - 根据AI返回的命名建议，批量更新frame内元素名称
  - 处理命名冲突（如：添加序号）
  - 向用户反馈命名结果（成功数量、失败情况）
  - 添加撤销功能（可选）

### 2.5 配置管理
- 创建配置文件`src/config.ts`：
  - 定义内置命名规范和案例
  - 存储AI API配置（支持用户输入）
  - 支持用户自定义命名规则

## 3. 技术要点
- **Figma Plugin API**：使用`figma.currentPage.selection`获取选中元素，`figma.listAvailableFontsAsync()`处理字体
- **递归遍历**：使用深度优先遍历处理嵌套frame和组件
- **AI提示词设计**：包含足够的上下文信息，引导AI生成符合规范的命名
- **异步处理**：使用`async/await`确保API调用不阻塞插件运行
- **错误处理**：处理网络错误、AI返回异常、Figma API限制等情况
- **UI设计**：严格遵循UI-DESIGN-SYSTEM.md的设计规范

## 4. 需要用户提供的信息
- 火山AI API的访问密钥和相关配置（endpoint、model等）
- 具体的命名规范和案例

## 5. 实现顺序
1. UI界面设计与实现
2. Figma结构获取功能
3. AI服务集成框架
4. 自动命名逻辑
5. 配置管理
6. 测试和优化

## 6. 预期效果
- 用户选择frame后，插件自动获取结构信息
- 点击"马上重命名"按钮后，显示加载状态
- AI处理完成后，批量更新元素名称
- 显示命名结果统计（如："成功命名23个元素"）
- 支持用户查看命名前后的对比

这个计划将确保插件能够按照需求实现自动命名功能，同时保持良好的用户体验和符合设计规范的UI。